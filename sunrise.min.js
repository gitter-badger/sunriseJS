!function(a){var b=a.$rootScope=a.$rootScope||{};b.core=["io","controls","canvas","ressourceLoader","util","CoreObject","Sprite","Entity","Stage"],b.functions={},_seal=a._seal=a._seal||function(){delete a.$rootScope,delete a._seal,delete a._unseal},_unseal=a._unseal=a._unseal||function(){a.$rootScope=b,a._seal=_seal,a._unseal=_unseal},a.loadScript=function(a,b){return void b()},a.isFunction=function(a){var b={};return a&&"[object Function]"===b.toString.call(a)},a.sunrise=function(){a._seal(),a.initCanvas(),a.loadImages(game.config.images,function(){game.init(b.$scope),a.run()})},a.run=function(){b.clearCanvas(),game.run(b.$scope),b.drawStage(),b.animationFrame.call(window,a.run)},a.fps={startTime:0,frameNumber:0,getFps:function(){this.frameNumber++;var a=(new Date).getTime(),b=(a-this.startTime)/1e3,c=Math.floor(this.frameNumber/b);return b>1&&(this.startTime=(new Date).getTime(),this.frameNumber=0),c}},a.initPlugins=function(){};var c=function(){b.animationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)},b.$scope={}};b.dom=document.querySelector("div[sunriseJS-app]"),void 0!=b.dom?c():alert("no jsengine-app found")}($sr=window.$sr=window.$sr||{});
!function(a){var b=a.$rootScope;b.events={},b.$scope.events={},a.log=function(){return console.log.apply(console,arguments)},b.emit=function(a,c){void 0!=b.events[a]?b.events[a].forEach(function(a){a(c)}):console.error("there is no event named: "+a)},b.on=function(a,c){void 0!=b.events[a]?b.events[a].push(c):(b.events[a]=[],b.events[a].push(c))},b.$scope.emit=function(a,c){void 0!=b.$scope.events[a]?b.$scope.events[a].forEach(function(a){a(c)}):console.error("there is no event named: "+a)},b.$scope.on=function(a,c){void 0!=b.$scope.events[a]?b.$scope.events[a].push(c):(b.$scope.events[a]=[],b.$scope.events[a].push(c))}}($sr=window.$sr=window.$sr||{});
!function(a){function b(){c.generateKeys()}var c=a.$rootScope;a.controls={},c.controls={keys:{},keycallbacks:{},keysPressed:{}},a.controls.onKeyDown=function(){for(var b=[],d=[],e=0;e<arguments.length;){for(b=[],d=[];!a.isFunction(arguments[e]);)b.push(arguments[e]),e++;for(;a.isFunction(arguments[e]);)d.push(arguments[e]),e++;for(var f=0;f<b.length;f++)void 0==c.controls.keycallbacks[b[f]]&&(c.controls.keycallbacks[b[f]]=d),c.controls.keycallbacks[b[f]]=c.controls.keycallbacks[b[f]].concat(d).unique()}},a.controls.onKeyUp=function(){c.controls.keycallbacks[key]=callback},c.handleKeyDown=function(a){if(!c.controls.keysPressed[a.keyCode]){if(void 0!=c.controls.keycallbacks[c.controls.keys.names[a.keyCode]])for(var b=0;b<c.controls.keycallbacks[c.controls.keys.names[a.keyCode]].length;++b)c.controls.keycallbacks[c.controls.keys.names[a.keyCode]][b]();c.controls.keysPressed[a.keyCode]=!0}},c.handleKeyUp=function(a){c.controls.keysPressed[a.keyCode]=!1},c.on("canvas-fully-loaded",function(){c.canvas.addEventListener("keydown",c.handleKeyDown),c.canvas.addEventListener("keyup",c.handleKeyUp)}),a.controls.isKeyPressed=function(){var a=!0;for(i=-1;++i<arguments.length&&a;)a=c.controls.keysPressed[c.controls.keys.codes[arguments[i]]]||c.controls.keysPressed[arguments[i]];return a},c.generateKeys=function(){var a={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,windows:91,"right click":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},b={ctl:17,pause:19,"break":19,caps:20,escape:27,pgup:33,pgdn:33,ins:45,del:46,spc:32};for(d=97;123>d;d++)a[String.fromCharCode(d)]=d-32;for(var d=48;58>d;d++)a[d-48]=d;for(d=1;13>d;d++)a["f"+d]=d+111;for(d=0;10>d;d++)a["numpad "+d]=d+96;var e={};for(d in a)e[a[d]]=d;for(var f in b)a[f]=b[f];c.controls.keys.codes=a,c.controls.keys.names=e},b()}($sr=window.$sr=window.$sr||{});
!function(a){var b=a.$rootScope;a.initCanvas=function(){var a=game.config.screenWidth,c=game.config.screenHeight,d=document.createElement("canvas");d.id="sunriseJS-screen",d.width=a,d.height=c,d.tabIndex="1",b.dom.appendChild(d),b.canvas=d,b.canvas.context=d.getContext("2d"),d.focus(),b.emit("canvas-fully-loaded")},b.clearCanvas=function(){b.canvas.context.save(),b.canvas.context.setTransform(1,0,0,1,0,0),b.canvas.context.clearRect(0,0,game.config.screenWidth,game.config.screenHeight),b.canvas.context.restore()},a.strokeRect=function(a,c,d,e){return b.canvas.context.strokeRect(a,c,d,e)}}($sr=window.$sr=window.$sr||{});
!function(a){var b=a.$rootScope;b.ressources={images:{},sprites:{},audio:{}},a.loadImages=function(a,c){var d={};for(key in a)d[key]=a[key];for(title in d)!function(a,e){var f,g;if(console.log(e),"object"==typeof e){if(void 0===e.source)throw new Error('No attribute "source" found in image '+title);f=e.source,g=e,g.name=title}else f=e,g={},g.name=title;if(void 0!==b.ressources.images[a])throw new Error("Imageressource with name "+a+" already exists");var h=new Image;h.onload=function(){delete d[a],b.ressources.images[a]=this;var e=!0;for(index in d){e=!1;break}e&&c()},h.src=f}(title,d[title])}}(window.$sr=window.$sr||{});
!function(a){function b(b,c,d){if("object"==typeof b){if(!b instanceof a.util.Vec2)throw new Error("Can't use "+b+"as Vec2");d(b)}else{if(void 0===c||"undefined"==typeof c)throw new Error("Excpected value for y");d(new a.util.Vec2(b,c))}}a.$rootScope;a.util={},a.util.Vec2=function(b,c){if("object"==typeof b){if(!b instanceof a.util.Vec2)throw new Error("Can't use "+b+"as Vec2");this.x=b.x,this.y=b.y}else this.x=b,this.y=c},a.util.Vec2.prototype.add=function(a,c){var d=this;b(a,c,function(a){d.x+=a.x,d.y+=a.y})},a.util.Vec2.add=function(b,c){return new a.util.Vec2(b.x+c.x,b.y+c.y)},a.util.Vec2.prototype.subtract=function(a,c){var d=this;b(a,c,function(a){d.x-=a.x,d.y-=a.y})},a.util.Vec2.subtract=function(b,c){return new a.util.Vec2(b.x-c.x,b.y-c.y)},a.util.Vec2.prototype.sub=a.util.Vec2.prototype.subtract,a.util.Vec2.sub=a.util.Vec2.subtract,a.util.Vec2.prototype.multiply=function(a){this.x*=a,this.y*=a},a.util.Vec2.multiply=function(b,c){var d=new a.util.Vec2(b);return d.multiply(c),d},a.util.Vec2.prototype.mul=a.util.Vec2.prototype.multiply,a.util.Vec2.mul=a.util.Vec2.multiply,a.util.Vec2.prototype.divide=function(a){this.multiply(1/a)},a.util.Vec2.divide=function(b,c){var d=new a.util.Vec2(b);return d.divide(c),d},a.util.Vec2.prototype.div=a.util.Vec2.prototype.divide,a.util.Vec2.div=a.util.Vec2.divide,Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},Array.prototype.unique=function(){for(var a=this.concat(),b=0;b<a.length;++b)for(var c=b+1;c<a.length;++c)a[b]===a[c]&&a.splice(c--,1);return a}}($sr=window.$sr=window.$sr||{});
!function(a){a.CoreObject=function(){function a(){}return a.extend=function(a){a.prototype=Object.create(this.prototype),a.prototype.constructor=a,a.prototype.super_=this.prototype,a.extend=this.extend},a}()}($sr=window.$sr=window.$sr||{});
!function(a){var b=a.$rootScope;a.Sprite=function(){var c,d,e,f;return Sprite=function(a){if(void 0===game.config.images[a])throw new Error('No image with name "'+a+'" found');var g=game.config.images[a],h=[];(void 0!==g.tileWidth||void 0!==g.tileHeight||void 0!==g.animations)&&(h.push("tileWidth"),h.push("tileHeight")),h.forEach(function(a){if(void 0===g[a]||""===g[a])throw new Error('No element "'+a+'" specified in data')});var i=b.ressources.images[a];void 0===g.tileWidth&&(g.tileWidth=i.width,g.tileHeight=i.height),void 0===g.animations&&(g.animations={}),void 0===g.animations.default&&(g.animations.default=[0]),c=i,d=g.tileWidth,e=g.tileHeight,this.rotation=0,this.alpha=1,f=g.animations,this.anchor={x:0,y:0},this.context=b.canvas.context;for(anim in f){this.currentAnimation=f[anim];break}this.currentFrame=0,this.lastDrawTime=Date.now(),this.frameDuration=60,this.cols=Math.floor(i.width/d),this.rows=Math.floor(i.height/e)},a.CoreObject.extend(Sprite),Sprite.prototype.draw=function(a,b,f,g){if(a-=this.anchor.x,b-=this.anchor.y,1!==this.alpha){var h=this.context.globalAlpha;this.context.globalAlpha=this.alpha}0!==this.rotation&&(this.context.save(),this.context.translate(a,b),this.context.rotate(this.rotation),this.context.translate(-a,-b));var i=f||d,j=g||e,k=this.currentAnimation[this.currentFrame],l=k%this.cols*d,m=Math.floor(k/this.cols)*e;this.context.drawImage(c,l,m,d,e,a,b,i,j);var n=Date.now(),o=n-this.lastDrawTime;o>=this.frameDuration&&(this.currentFrame++,this.currentFrame>=this.currentAnimation.length&&(this.currentFrame=0),this.lastDrawTime=n),1!==this.alpha&&(this.context.globalAlpha=h),0!==this.rotation&&this.context.restore()},Sprite.prototype.setAnimation=function(a,b){if(void 0===f[a])throw new Error("No animation with name "+a+" found");(this.currentAnimation!=f[a]||void 0!==b)&&(this.currentAnimation=f[a],this.currentFrame=b||0)},Sprite.prototype.setRotationDeg=function(a){this.setRotationRad(a*Math.PI/180)},Sprite.prototype.setRotationRad=function(a){a%=2*Math.PI,this.rotation=a},Sprite.prototype.setAlpha=function(a){a=0>a?0:a,a=a>1?1:a,this.alpha=a},Sprite.prototype.setAnchor=function(a,b){"object"==typeof a&&"undefined"!=typeof a.x&&"undefined"!=typeof a.y?(this.anchor.x=a.x,this.anchor.y=a.y):(this.anchor.x=a,this.anchor.y=b)},Sprite}()}($sr=window.$sr=window.$sr||{});
!function(a){a.$rootScope;a.Entity=function(){function b(b,d,e){a.Sprite.call(this,e),c=new a.util.Vec2(b,d),this.position=c}var c;return a.Sprite.extend(b),b.prototype.draw=function(){this.super_.draw.call(this,c.x,c.y)},b}()}($sr=window.$sr=window.$sr||{});
!function(a){var b=a.$rootScope,c=[];a.stage={},a.stage.add=function(b){if(!b instanceof a.Entity)throw new Error("Only entities can be added to stage");c.push(b),console.log("added to stage. entities:",c)},b.drawStage=function(){c.forEach(function(a){a.draw()})}}($sr=window.$sr=window.$sr||{});
!function(a){a.$rootScope;a.sunrise()}($sr=window.$sr=window.$sr||{});